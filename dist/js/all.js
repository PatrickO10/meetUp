function TrackIssues(){this.issues=[]}var submitSignUp=document.getElementById("submitSignUp"),submitLogin=document.getElementById("submitLogin"),logPass=document.getElementById("logPass"),logEmail=document.getElementById("logEmail"),firstPasswordEl=document.getElementById("fPassword"),secondPasswordEl=document.getElementById("sPassword"),autocomplete;TrackIssues.prototype={addIssues:function(e){this.issues.push(e)},retrieveIssues:function(){var e="";return 1===this.issues.length?e="The following issue needs to be corrected:\n"+this.issues[0]:this.issues.length>1&&(e="The following issues need to be corrected:\n"+this.issues.join("\n")),e}},$(".signUp, .newEvent, .login").on("shown.bs.modal",function(){$("#fname").focus(),$("#eName").focus(),$("#logEmail").focus()}),function(){"use strict";var e=angular.module("meetupEventApp",["firebase"]);e.controller("MeetupEventCtrl",["$firebaseArray",function(e){var s=new Firebase("https://vivid-torch-762.firebaseio.com/"),t=this;t.master={},t.masterUser={},t.masterEvent={},t.userRef="",t.user={eventLoc:""},t.userEvents="",t.userNew=!1;var r=document.getElementById("loc-input");autocomplete=new google.maps.places.Autocomplete(r),autocomplete.addListener("place_changed",function(){var e=autocomplete.getPlace();t.user.eventLoc=e.formatted_address}),t.createEvent=function(e){t.masterEvent=angular.copy(e),""===t.userRef?console.log("Please login to continue"):(t.userEvents.push({name:t.masterEvent.name,type:t.masterEvent.type,host:t.masterEvent.host,startDate:t.masterEvent.startDate.getTime(),endDate:t.masterEvent.endDate.getTime(),location:t.user.eventLoc,guests:t.masterEvent.guests}),t.newEvent={},$("#newEventForm")[0].reset(),$(".newEvent").modal("hide"))},t.login=function(r){t.master=angular.copy(r),t.userNew=!1,t.master.email&&t.master.pass&&s.authWithPassword({email:t.master.email,password:t.master.pass},function(r,a){r?console.log("Login Failed!",r):(console.log("Authenticated successfully with payload:",a),t.userRef=s.child("users").child(a.uid),t.userEvents=t.userRef.child("events"),t.eventsArray=e(t.userEvents),$("#loginForm")[0].reset(),$(".login").modal("hide"))})},t.signUp=function(r){function a(){t.masterUser.fPassword.length<8?n.addIssues("fewer than 8 characters"):t.masterUser.fPassword.length>50&&n.addIssues("greater than 50 characters"),t.masterUser.fPassword.match(/[\!\@\#\$\%\^\&\*]/g)||n.addIssues("missing a symbol (!, @, #, $, %, ^, &, *)"),t.masterUser.fPassword.match(/\d/g)||n.addIssues("missing a number"),t.masterUser.fPassword.match(/[a-z]/g)||n.addIssues("missing a lowercase letter"),t.masterUser.fPassword.match(/[A-Z]/g)||n.addIssues("missing an uppercase letter");var e=t.masterUser.fPassword.match(/[^A-z0-9\!\@\#\$\%\^\&\*]/g);e&&e.forEach(function(e){n.addIssues("includes bad character: "+e)})}t.masterUser=angular.copy(r),t.userNew=!0;var n=new TrackIssues,o=new TrackIssues;t.masterUser.fPassword===t.masterUser.sPassword&&t.masterUser.fPassword.length>0?a():o.addIssues("Passwords must match!");var i=n.retrieveIssues(),u=o.retrieveIssues();firstPasswordEl.setCustomValidity(i),secondPasswordEl.setCustomValidity(u),i.length||u.length||s.createUser({email:t.masterUser.email,password:t.masterUser.fPassword},function(r,a){r?console.log("Error creating user:",r):(console.log("Successfully created user account with uid:",a.uid),s.authWithPassword({email:t.masterUser.email,password:t.masterUser.fPassword},function(r,a){r?console.log("Login Failed!",r):(console.log("Authenticated successfully with payload:",a),t.userRef=s.child("users").child(a.uid),t.userRef.set({provider:a.provider,name:t.masterUser.fname,email:t.masterUser.email}),t.userEvents=t.userRef.child("events"),t.eventsArray=e(t.userEvents))}),$("#signUpForm")[0].reset(),$(".signUp").modal("hide"))})}}])}();